<!DOCTYPE html>
<html lang="en"> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ingreso</title>
    <link rel="stylesheet" href="styles/styles.css">
    <script src="https://kit.fontawesome.com/d2aae01839.js" crossorigin="anonymous"></script>
</head>
<body>
    <header class="header bg-primary ds-flex jc-sb pd-y-16 pd-x-24 font-secondary text-white align-center">
        <div></div>
        <div onclick="location.href='index.html'" style="cursor: pointer;">
            <span class="pd-r-8 font-bold font-primary">Cerrar Sesión</span>
            <i class="fa-solid fa-right-from-bracket text-white text-xl"></i>
        </div>
    </header>    
    <main class="d-flex gap-lg">
        <nav class="sidemenu bg-light">
            <img src="images/wallet-512px.png" alt="wallet">
            <span class="text-dark font-primary text-center pd-b-16">Chaucherita<br>Web</span>
            <ul class="menu ls-none">
                <li>
                    <button class="menu-button" onclick="location.href='home.html'">
                        <i class="fa-solid fa-house text-xl"></i> Regresar
                    </button>
                </li>
            </ul>
        </nav>        
        <div class="main-content p-md">
            <h2 class="font-primary text-dark">Registrar Ingreso</h2>
            <form id="ingreso-form" class="font-primary" action="home.html" method="get">
                <div class="form-group py-sm">
                    <label for="valor">Valor:</label>
                    <input type="number" id="valor" name="valor" class="input text-base" placeholder="Ingrese el valor" required>
                </div>
                <div class="form-group py-sm">
                    <label for="descripcion">Descripción (Opcional):</label>
                    <input id="descripcion" name="descripcion" class="input text-base" placeholder="Descripción del ingreso">
                </div>
                <div class="form-group py-sm">
                    <label for="cuenta">Cuenta Destino:</label>
                    <select id="cuenta" name="cuenta" class="input text-base" required>
                        <option value="" disabled selected>Seleccione una cuenta</option>
                        <option value="ahorros">Cuenta de Ahorros</option>
                        <option value="corriente">Cuenta Corriente</option>
                    </select>
                </div>
                <div class="form-group py-sm d-flex align-start gap-xs">
                    <label for="etiqueta" class="text-left" style="min-width: 70px;">Etiqueta:</label>
                    <div class="d-flex flex-column gap-xs" style="width: 100%;">
                        <select id="etiqueta" name="etiqueta" class="input text-base" required>
                            <option value="" disabled selected>Seleccione una etiqueta</option>
                        </select>
                        <button type="button" class="button bg-primary text-white" style="width: fit-content;" onclick="abrirCategorias()">Gestionar Etiquetas</button>
                    </div>
                </div>
                <div id="formulario-agregar-etiqueta" class="hidden">
                    <h3 class="font-primary text-dark">Agregar Nueva Etiqueta</h3>
                    <div class="form-group py-md">
                        <label for="nueva-etiqueta">Nombre de la Etiqueta:</label>
                        <input type="text" id="nueva-etiqueta" name="nueva-etiqueta" class="input text-base" placeholder="Ingrese el nombre de la etiqueta">
                    </div>
                    <button type="button" class="button bg-primary text-white" onclick="agregarCategoria()">Agregar Etiqueta</button>
                </div>
                <div class="py-md" id="boton-registrar-container">
                    <button type="submit" class="button bg-primary text-white">Registrar Ingreso</button>
                </div>
            </form>
        </div>
    </main>
    <script src="js/categorias.js"></script>
    <script src="js/cuentas.js"></script>
    <script>
        function abrirCategorias() {
            window.location.href = 'categorias.html';
        }

        window.onload = function() {
            cargarEtiquetas();
            cargarCuentas();
            var selectedCategory = localStorage.getItem('selectedCategory');
            if (selectedCategory) {
                document.getElementById('etiqueta').value = selectedCategory;
                localStorage.removeItem('selectedCategory');
            }
        };

        function cargarEtiquetas() {
            var etiquetas = JSON.parse(localStorage.getItem('categorias')) || [];
            var etiquetaSelect = document.getElementById('etiqueta');
            etiquetaSelect.innerHTML = '<option value="" disabled selected>Seleccione una etiqueta</option>';

            etiquetas.forEach(function(etiqueta) {
                var option = document.createElement('option');
                option.value = etiqueta.nombre;
                option.textContent = etiqueta.nombre;
                etiquetaSelect.appendChild(option);
            });
        }

        function cargarCuentas() {
            var cuentas = JSON.parse(localStorage.getItem('cuentas')) || [];
            var cuentaSelect = document.getElementById('cuenta');
            cuentaSelect.innerHTML = '<option value="" disabled selected>Seleccione una cuenta</option>';

            cuentas.forEach(function(cuenta) {
                var option = document.createElement('option');
                option.value = cuenta.nombre;
                option.textContent = cuenta.nombre;
                cuentaSelect.appendChild(option);
            });
        }
    </script>
</body>
</html>